{% extends "rsvp_base.html" %}
{% block title %}RSVP - {{ event.title }}{% endblock %}

{% block content %}
<div class="rsvp-container">
    <!-- Invitation Display -->
    <div class="invitation-display">
        {{ invitation_html | safe }}
    </div>

    <!-- RSVP Section -->
    <div class="rsvp-section">
        <div class="rsvp-card">
            <h2>RSVP</h2>
            <p class="guest-name">Hi {{ invitee.name }}!</p>

            <div class="event-summary">
                <div class="detail"><span class="label">Event</span> {{ event.title }}</div>
                <div class="detail"><span class="label">Date</span> {{ format_date(event.date) }}</div>
                <div class="detail"><span class="label">Time</span> {{ format_time(event.time) }}</div>
                <div class="detail"><span class="label">Location</span> {{ event.location }}</div>
            </div>

            {% if invitee.status != 'pending' %}
            <div class="current-status">
                <p>Your current response:</p>
                <span class="status-badge status-{{ invitee.status }}">
                    {% if invitee.status == 'accepted' %}Attending{% elif invitee.status == 'declined' %}Not Attending{% else %}Maybe{% endif %}
                </span>
                <p class="change-hint">You can change your response below.</p>
            </div>
            {% endif %}

            {% set responded = request.args.get('responded') %}
            {% if responded %}
            <div class="response-confirmation">
                {% if responded == 'accepted' %}
                    Thank you! We look forward to seeing you there.
                {% elif responded == 'maybe' %}
                    Thanks for letting us know! We hope you can make it.
                {% elif responded == 'declined' %}
                    Thank you for letting us know. We'll miss you!
                {% endif %}
            </div>
            {% endif %}

            <form method="POST" action="{{ url_for('public.rsvp_respond', token=token) }}" class="rsvp-buttons">
                <button type="submit" name="status" value="accepted" class="rsvp-btn rsvp-accept {% if invitee.status == 'accepted' %}active{% endif %}">
                    <span class="btn-icon">&#10003;</span>
                    Accept
                </button>
                <button type="submit" name="status" value="maybe" class="rsvp-btn rsvp-maybe {% if invitee.status == 'maybe' %}active{% endif %}">
                    <span class="btn-icon">?</span>
                    Maybe
                </button>
                <button type="submit" name="status" value="declined" class="rsvp-btn rsvp-decline {% if invitee.status == 'declined' %}active{% endif %}">
                    <span class="btn-icon">&#10007;</span>
                    Decline
                </button>
            </form>
        </div>
    </div>
</div>
{% endblock %}
